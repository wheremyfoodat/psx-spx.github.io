
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://psx-spx.consoledev.net/interrupts/" rel="canonical"/>
<link href="../assets/images/favicon.png" rel="shortcut icon"/>
<meta content="mkdocs-1.1.2, mkdocs-material-6.2.6" name="generator"/>
<title>Interrupts - PlayStation Specifications - psx-spx</title>
<link href="../assets/stylesheets/main.cb6bc1d0.min.css" rel="stylesheet"/>
<link href="../assets/stylesheets/palette.39b8e14a.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
<link href="../css/extra.css" rel="stylesheet"/>
</head>
<body data-md-color-accent="none" data-md-color-primary="none" data-md-color-scheme="" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#interrupts">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header-nav md-grid">
<a aria-label="PlayStation Specifications - psx-spx" class="md-header-nav__button md-logo" href="https://psx-spx.consoledev.net/" title="PlayStation Specifications - psx-spx">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg>
</a>
<label class="md-header-nav__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header-nav__title" data-md-component="header-title">
<div class="md-header-nav__ellipsis">
<div class="md-header-nav__topic">
<span class="md-ellipsis">
            PlayStation Specifications - psx-spx
          </span>
</div>
<div class="md-header-nav__topic">
<span class="md-ellipsis">
            
              Interrupts
            
          </span>
</div>
</div>
</div>
<label class="md-header-nav__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" data-md-state="active" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<button aria-label="Clear" class="md-search__icon md-icon" data-md-component="search-reset" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="PlayStation Specifications - psx-spx" class="md-nav__button md-logo" href="https://psx-spx.consoledev.net/" title="PlayStation Specifications - psx-spx">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg>
</a>
    PlayStation Specifications - psx-spx
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="..">
        Home
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../memorymap/">
        Memory Map
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../iomap/">
        I/O Map
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../graphicsprocessingunitgpu/">
        Graphics Processing Unit (GPU)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../geometrytransformationenginegte/">
        Geometry Transformation Engine (GTE)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../macroblockdecodermdec/">
        Macroblock Decoder (MDEC)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../soundprocessingunitspu/">
        Sound Processing Unit (SPU)
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Interrupts
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Interrupts
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#1f801070h-i_stat-interrupt-status-register-rstatus-wacknowledge">
    1F801070h I_STAT - Interrupt status register (R=Status, W=Acknowledge)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#1f801074h-i_mask-interrupt-mask-register-rw">
    1F801074h I_MASK - Interrupt mask register (R/W)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#secondary-irq10-controller-port-1f802030h">
    Secondary IRQ10 Controller (Port 1F802030h)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#interrupt-request-execution">
    Interrupt Request / Execution
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#interrupt-acknowledge">
    Interrupt Acknowledge
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cop0-interrupt-handling">
    COP0 Interrupt Handling
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#psx-specific-cop0-notes">
    PSX specific COP0 Notes
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#halt-function-wait-for-interrupt">
    Halt Function (Wait for Interrupt)
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../dmachannels/">
        DMA Channels
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../timers/">
        Timers
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../cdromdrive/">
        CDROM Drive
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../controllersandmemorycards/">
        Controllers and Memory Cards
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../pocketstation/">
        Pocketstation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../serialportsio/">
        Serial Port (SIO)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../expansionportpio/">
        Expansion Port (PIO)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../memorycontrol/">
        Memory Control
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../unpredictablethings/">
        Unpredictable Things
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../cpuspecifications/">
        CPU Specifications
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../kernelbios/">
        Kernel (BIOS)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../arcadecabinets/">
        Arcade Cabinets
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../cheatdevices/">
        Cheat Devices
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../psxdevboardchipsets/">
        PSX Dev-Board Chipsets
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hardwarenumbers/">
        Hardware Numbers
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../pinouts/">
        Pinouts
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../aboutcredits/">
        About &amp; Credits
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../cdromvideocdsvcd/">
        CDROM Video CDs (VCD)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../cdrominternalinfoonpsxcdromcontroller/">
        CDROM Internal Info on PSX CDROM Controller
      </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#1f801070h-i_stat-interrupt-status-register-rstatus-wacknowledge">
    1F801070h I_STAT - Interrupt status register (R=Status, W=Acknowledge)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#1f801074h-i_mask-interrupt-mask-register-rw">
    1F801074h I_MASK - Interrupt mask register (R/W)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#secondary-irq10-controller-port-1f802030h">
    Secondary IRQ10 Controller (Port 1F802030h)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#interrupt-request-execution">
    Interrupt Request / Execution
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#interrupt-acknowledge">
    Interrupt Acknowledge
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cop0-interrupt-handling">
    COP0 Interrupt Handling
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#psx-specific-cop0-notes">
    PSX specific COP0 Notes
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#halt-function-wait-for-interrupt">
    Halt Function (Wait for Interrupt)
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<h1 id="interrupts">Interrupts</h1>
<h4 id="1f801070h-i_stat-interrupt-status-register-rstatus-wacknowledge">1F801070h I_STAT - Interrupt status register (R=Status, W=Acknowledge)</h4>
<h4 id="1f801074h-i_mask-interrupt-mask-register-rw">1F801074h I_MASK - Interrupt mask register (R/W)</h4>
<p>Status: Read I_STAT (0=No IRQ, 1=IRQ)<br/>
Acknowledge: Write I_STAT (0=Clear Bit, 1=No change)<br/>
Mask: Read/Write I_MASK (0=Disabled, 1=Enabled)<br/></p>
<pre><code>  0     IRQ0 VBLANK (PAL=50Hz, NTSC=60Hz)
  1     IRQ1 GPU   Can be requested via GP0(1Fh) command (rarely used)
  2     IRQ2 CDROM
  3     IRQ3 DMA
  4     IRQ4 TMR0  Timer 0 aka Root Counter 0 (Sysclk or Dotclk)
  5     IRQ5 TMR1  Timer 1 aka Root Counter 1 (Sysclk or H-blank)
  6     IRQ6 TMR2  Timer 2 aka Root Counter 2 (Sysclk or Sysclk/8)
  7     IRQ7 Controller and Memory Card - Byte Received Interrupt
  8     IRQ8 SIO
  9     IRQ9 SPU
  10    IRQ10 Controller - Lightpen Interrupt. Also shared by PIO and DTL cards.
  11-15 Not used (always zero)
  16-31 Garbage
</code></pre>
<h4 id="secondary-irq10-controller-port-1f802030h">Secondary IRQ10 Controller (Port 1F802030h)</h4>
<p><a href="../expansionportpio/#exp2-dtl-h2000-io-ports">EXP2 DTL-H2000 I/O Ports</a><br/></p>
<h4 id="interrupt-request-execution">Interrupt Request / Execution</h4>
<p>The interrupt request bits in I_STAT are edge-triggered, ie. the get set ONLY
if the corresponding interrupt source changes from "false to true".<br/>
If one or more interrupts are requested and enabled, ie. if "(I_STAT AND
I_MASK)=nonzero", then cop0r13.bit10 gets set, and when cop0r12.bit10 and
cop0r12.bit0 are set, too, then the interrupt gets executed.<br/></p>
<h4 id="interrupt-acknowledge">Interrupt Acknowledge</h4>
<p>To acknowledge an interrupt, write a "0" to the corresponding bit in I_STAT.
Most interrupts (except IRQ0,4,5,6) must be additionally acknowledged at the
I/O port that has caused them (eg. JOY_CTRL.bit4).<br/>
Observe that the I_STAT bits are edge-triggered (they get set only on
High-to-Low, or False-to-True edges). The correct acknowledge order is:<br/></p>
<pre><code>  First, acknowledge I_STAT                (eg. I_STAT.bit7=0)
  Then, acknowledge corresponding I/O port (eg. JOY_CTRL.bit4=1)
</code></pre>
<p>When doing it vice-versa, the hardware may miss further IRQs (eg. when first
setting JOY_CTRL.4=1, then a new IRQ may occur in JOY_STAT.4 within a single
clock cycle, thereafter, setting I_STAT.7=0 would successfully reset I_STAT.7,
but, since JOY_STAT.4 is already set, there'll be no further edge, so I_STAT.7
won't be ever set in future).<br/></p>
<h4 id="cop0-interrupt-handling">COP0 Interrupt Handling</h4>
<p>Relevant COP0 registers are cop0r13 (CAUSE, reason flags), and cop0r12 (SR,
control flags), and cop0r14 (EPC, return address), and, cop0cmd=10h (aka RFE
opcode) is used to prepare the return from interrupts. For more info, see<br/>
<a href="../cpuspecifications/#cop0-exception-handling">COP0 - Exception Handling</a><br/></p>
<h4 id="psx-specific-cop0-notes">PSX specific COP0 Notes</h4>
<p>COP0 has six hardware interrupt bits, of which, the PSX uses only cop0r13.bit10
(the other ones, cop0r13.bit11-15 are always zero). cop0r13.bit10 is NOT a
latch, ie. it gets automatically cleared as soon as "(I_STAT AND I_MASK)=zero",
so there's no need to do an acknowledge at the cop0 side. COP0 additionally has
two software interrupt bits, cop0r13.bit8-9, which do exist in the PSX, too,
these bits are read/write-able latches which can be set/cleared manually to
request/acknowledge exceptions by software.<br/></p>
<h4 id="halt-function-wait-for-interrupt">Halt Function (Wait for Interrupt)</h4>
<p>The PSX doesn't have a HALT opcode, so, even if the program is merely waiting
for an interrupt to occur, the CPU is always running at full speed, which is
resulting in high power consumption, and, in case of emulators, high CPU
emulation load. To save energy, and to make emulation smoother on slower
computers, I've added a Halt function for use in emulators:<br/>
<a href="../expansionportpio/#exp2-nocash-emulation-expansion">EXP2 Nocash Emulation Expansion</a><br/></p>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav aria-label="Footer" class="md-footer-nav__inner md-grid">
<a class="md-footer-nav__link md-footer-nav__link--prev" href="../soundprocessingunitspu/" rel="prev">
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                Sound Processing Unit (SPU)
              </div>
</div>
</a>
<a class="md-footer-nav__link md-footer-nav__link--next" href="../dmachannels/" rel="next">
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Next
                </span>
                DMA Channels
              </div>
</div>
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a>
 ... <a class="link--pdf-download" download href="../psx-spx.pdf" title="PDF">download PDF</a></div>
</div>
</div>
</footer>
</div>
<script src="../assets/javascripts/vendor.53cc9318.min.js"></script>
<script src="../assets/javascripts/bundle.e9c9f54f.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
<script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
</body>
</html>